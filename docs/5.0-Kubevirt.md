# Under Construction for BoB 2025

## Powerstore prereqs


configure interfaces in Openshift Cluster

```bash
ansible-playbook ../playbooks/playbook_set_lan2.yaml -i hosts.yaml
```

```bash
oc patch --type=merge network.operator.openshift.io/cluster \
--patch '{"spec":{"additionalNetworks":[{"name":"backup-lan","namespace":"openshift-host-network","rawCNIConfig":"{\"cniVersion\":\"0.3.1\",\"name\":\"backup-lan\",\"type\":\"host-device\",\"device\":\"ens224\",\"ipam\":{\"type\":\"whereabouts\",\"range\":\"192.168.2.192/27\",\"exclude\":[\"192.168.2.192/32\"]}}","type":"Raw"}]}}'
```

Configure Multipathing for the Openshift Worker Nodes
```bash
oc apply -f mc_multipath.yaml
```
It will take a while for the Machine Config Operator to configure teh Nodes with Multipath and reboots them

Configure iscsid
```bash
oc apply -f mc_iscsid.yaml
```


Generate config Secret for Powerstore

```bash
sed "s/CONFIG_YAML/`cat powerstore/config.yaml | base64 -w0`/g" powerstore/secret.yaml | oc apply -f -
```
Create the CSI Drivers for Powerstore

```bash
oc apply -f powerstore/storage_csm_powerstore_v2130.yaml
```

Create Storageclasses

```bash
oc apply -f powerstore/storageclass-powerstore-1.yaml
oc apply -f powerstore/storageclass-powerstore-2.yaml
oc apply -f powerstore/snapshotclass.yaml
```

```bash
oc apply -f powerstore/demopod.yaml
```
