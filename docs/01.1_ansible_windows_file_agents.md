# Working with windows file Agent
## Prerequisite

Make sure you prepared the environment using [ansible_ppdm_agents](./01.0_ansible_ppdm_agents.md)   
Make sure the "File VM" is starte
```bash
govc vm.power -on -vm.ipath="$(govc find / -type m -name file)"
```
it will take a while for the VM to be running. Check it is reachable using win_ping

## Validate agent host "file"  ping-able vi winrm

```bash
ansible file -m win_ping -i hosts.yaml
```
once we receive a "pong" the machine is up and reachable for ansible communicationÂ´s
![image](https://github.com/bob-builds-labs/bob-builds-labs.github.io/assets/8255007/c0b0f729-77e4-4bcb-b01b-bb4f8780a802)

## Installing the File Agent

### deploy agents to host "file"
The example will use the Inventory from the previously create file "hosts.yaml"
As we honly want to tackle the host named file, we use the --limit parameter
*the host lis for limit needs to end with a comma*

```bash
ansible-playbook ~/workspace/ansible_ppdm/100.3_playbook_copy_and_deploy_windows_agent.yaml -i hosts.yaml --limit file, 
```

### View Agent registration Status

```bash
ansible-playbook ~/workspace/ansible_ppdm/100.5_get_agent_registration_status.yaml
```


### Approve File Agent

```bash
ansible-playbook ~/workspace/ansible_ppdm/100.3_create_whitelistentry.yaml -e '{ "host_list" : [ "file.demo.local" ] }'
```

