# This Lab is about Deploying PPDM msappsagnt Exchange Agent(s)


Make sure you prepared the environment using [ansible_ppdm_agents](./01.0_ansible_ppdm_agents.md)   
Make sure the VMÂ´s exchange1 and exchange2 are started
```bash
govc vm.power -on -vm.ipath="$(govc find / -type m -name exchange1)"
govc vm.power -on -vm.ipath="$(govc find / -type m -name exchange2)"
```

### Validate agent hosts Group "exchgangehosts"  ping-able vi winrm

```bash
ansible exchangehosts -m win_ping -i hosts.yaml
```

![image](https://github.com/bob-builds-labs/bob-builds-labs.github.io/assets/8255007/2a783b9b-c581-46ee-ac9e-dfab41b27776)


As we honly want to tackle the group named exchangehosts, we use the --limit parameter

```bash
ansible-playbook ~/workspace/ansible_ppdm/100.3_playbook_copy_and_deploy_windows_agent.yaml -i hosts.yaml --limit exchangehosts, 
```
![image](https://github.com/bob-builds-labs/bob-builds-labs.github.io/assets/8255007/a68d6a4c-ab8e-430a-8731-f0f202141ef4)

### View Agent registration Status

```bash
ansible-playbook ~/workspace/ansible_ppdm/100.5_get_agent_registration_status.yaml
```
![image](https://github.com/bob-builds-labs/bob-builds-labs.github.io/assets/8255007/b7a23f1c-8687-4b58-a8cc-94b1abd4c1e1)

![image](https://github.com/bob-builds-labs/bob-builds-labs.github.io/assets/8255007/15c5d4ab-b22b-4a1a-9797-ae9e4f2bf34b)


### Approve Exchange Agents
We want to tackle the addresses of the hsost as they show up from above query, so we will use a runbook that queries the agentn list from name to address:
```bash
ansible-playbook ~/workspace/ansible_ppdm/100.4_create_whitelistentry_from_addressquery.yaml -e "host_list=exchange1.demo.local,exchange2.demo.local"
```
![image](https://github.com/bob-builds-labs/bob-builds-labs.github.io/assets/8255007/defb37ff-8cc4-4dde-8a9b-2c2c8788cbe4)

